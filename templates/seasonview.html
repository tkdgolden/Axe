<!--Page displaying a judge's options within a season (enroll competitor, start match, view players, recent matches)-->

<style>
    input[type="checkbox"]:checked + label {
        background: skyblue;
    }
</style>

{% extends "layout.html" %}

{% block judgepage %}
    <p>You are judging the {{ rows[0]["season"] }} {{ rows[0]["yearof"] }} {{ rows[0]["discipline"] }} season.</p>
    <a href="/">Leave Season/ Back to Judge Homepage</a>
{% endblock %}

{% block body %}
    
    <form>
        <label for="week">Week:</label>
        <input type="number" min="1" max="8" step="1" value="{{ session['week'] }}" name="week" id="week"/>
    </form>
    <table id="weeklymatchups" class="table table-info display" style="width:95%">
        <thead>
            <tr>
                <th class="table-active"></th>
                {% for player in players %}
                    <th class="grid {{ player['competitor_id']  }} toprow" data-player="{{ player['competitor_id'] }}">{{ player["competitor_first_name"] }} {{ player["competitor_last_name"] }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for player in players|reverse %}
                <tr>
                    <th class="grid toprow {{ player['competitor_id'] }}" data-player="{{ player['competitor_id'] }}">{{ player["competitor_first_name"] }} {{ player["competitor_last_name"] }}</t>
                    {% for opponent in players %}
                        {% if player == opponent %}
                            <td class="table-active"></td>
                        {% else %}
                            <td data-p1="{{ player['competitor_id']}}" data-p2="{{ opponent['competitor_id'] }}" class="{{ player['competitor_id'] }} {{ opponent['competitor_id'] }} squares">
                            {% for match in logged_matches %}
                                {% if ((match["player_1_id"] == player["competitor_id"]) and (match["player_2_id"] == opponent["competitor_id"])) or ((match["player_2_id"] == player["competitor_id"]) and (match["player_1_id"] == opponent["competitor_id"])) %}
                                    {% if match["winner_id"] == None %}
                                        <p data-match="{{ match['match_id'] }}">begun</p>
                                    {% else %}
                                        complete
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                            </td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <a href="/enrollcompetitor">Enroll a Competitor</a>

    <script type="text/javascript" src="{{ url_for('static', filename='js/season.js') }}"></script>

{% endblock %}

